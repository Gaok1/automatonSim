<!DOCTYPE html>
<html lang="pt-BR">

<head>
  <meta charset="utf-8" />
  <title>Gramática/ER → Autômato</title>
  <meta name="viewport" content="width=device-width, initial-scale=1" />
    <link rel="stylesheet" href="style.css">
</head>

<body>

  <nav class="tabs">
    <a href="index.html">AFD</a>
    <a href="afn.html">AFN</a>
    <a href="gr.html" class="active">GR</a>
  </nav>

  <div class="left">
    <div class="card">
      <h2>Expressão Regular</h2>
      <input type="text" id="regexInput" placeholder="Ex: (a∪b)*a" />
      <div class="row">
        <button id="buildFromRegexBtn" class="btn-accent">Gerar AF</button>
      </div>
      <div class="mini muted">Use ∪ para união, * para fecho e λ para vazio.</div>
    </div>

    <div class="card">
      <h2>Gramática Regular</h2>
      <textarea id="grammarInput" rows="6" placeholder="S->aA|b&#10;A->aS|λ"></textarea>
      <div class="row">
        <button id="buildFromGrammarBtn" class="btn-accent">Gerar AF</button>
      </div>
      <div class="mini muted">Use λ para a produção vazia.</div>
    </div>

    <div class="card">
      <h2>Alfabeto</h2>
      <div class="row">
        <input type="text" id="alphabetInput" placeholder="Símbolos separados por vírgula. Ex: A,B" />
        <button class="btn-accent" id="setAlphabetBtn">Definir</button>
        <span class="muted mini">Use apenas símbolos unitários (sem strings). Ex.: <span class="kbd">A</span>, <span
            class="kbd">B</span>, <span class="kbd">0</span>, <span class="kbd">1</span>.</span>
      </div>
      <div id="alphabetView" class="pill muted">Σ = { }</div>
    </div>

    <div class="card">
      <h2>Estados</h2>
      <div class="toolbar">
        <button id="addStateBtn">+ Estado</button>
        <button id="toggleInitialBtn" class="btn-soft">Alternar Inicial</button>
        <button id="toggleFinalBtn" class="btn-soft">Alternar Final</button>
        <button id="deleteSelectedBtn" class="btn-danger">Excluir Selecionado</button>
        <button id="resetBtn" class="btn-danger">Limpar AF</button>
      </div>
      <div class="legend">
        <span class="dot dot-initial"></span><span class="mini">Inicial</span>
        <span class="dot dot-final"></span><span class="mini">Final</span>
        <span class="dot dot-halt"></span><span class="mini">HALT (transição ausente)</span>
      </div>
      <div class="hr"></div>
      <div class="row mini muted">Dica: clique em um estado para selecioná-lo. Use <span class="kbd">C</span> ou o ícone
        de ligação para conectar: clique na origem e depois no destino para escolher o símbolo.</div>
    </div>

    <div class="card grid cols-2">
      <div>
        <h2>Simular Palavra</h2>
        <div class="row">
          <input type="text" id="wordInput" placeholder="Ex: ABAAB" />
          <button id="runBtn" class="btn-accent">Rodar</button>
          <button id="runStartBtn" class="btn-soft">Modo Run</button>
          <button id="runStepBtn" class="btn-soft" disabled>Passo</button>
        </div>
        <div id="runResult" class="mini"></div>
        <div id="runSteps" class="scroll mini"></div>
      </div>
      <div>
        <h2>Expressão Regular (AFD → ER)</h2>
        <div class="row">
          <label><input type="checkbox" id="allowEpsilon" /> Permitir λ na saída</label>
          <button id="buildRegexBtn">Gerar ER</button>
        </div>
        <div id="regexMsg" class="mini muted"></div>
        <div id="regexOut" class="pill" style="margin-top:6px; font-weight:700; font-size:15px;"></div>
      </div>
    </div>

    <div class="card">
      <h2>Exportar / Importar</h2>
      <div class="toolbar">
        <button id="exportBtn" class="btn-soft">Exportar AF</button>
        <button id="importBtn" class="btn-soft">Importar AF</button>
        <button id="exportPngBtn" class="btn-soft">Exportar PNG</button>
        <input type="file" id="importFile" accept="application/json" style="display:none" />
      </div>
      <div class="row" style="margin-top:6px;">
        <select id="examplesSelect">
          <option value="">Carregar exemplo...</option>
        </select>
        <button id="loadExampleBtn" class="btn-soft">Carregar</button>
      </div>
      <div class="mini muted">Exporta um JSON com Σ, estados, transições, inicial e <code>nextId</code>. Importar
        substituirá o AF atual.</div>
    </div>

    <div class="card">
      <h2>Conversões</h2>
      <div class="toolbar">
        <button id="lambdaToNfaBtn" class="btn-soft">AFNλ → AFN</button>
        <button id="nfaToDfaBtn" class="btn-soft">AFN → AFD</button>
      </div>
      <div id="algoSteps" class="mini scroll"></div>
    </div>
  </div>

  <div class="right card" style="flex:1.2">
    <h2>Canvas</h2>
    <div id="canvasWrapper">
      <svg id="svg">
        <defs>
          <marker id="arrow" markerWidth="18" markerHeight="12" refX="10" refY="6" orient="auto"
            markerUnits="strokeWidth">
            <path d="M0,0 L10,6 L0,12 z" fill="#cbd5e1"></path>
          </marker>
        </defs>
        <g id="edges"></g>
        <g id="labels"></g>
        <g id="initialPointers"></g>
        <g id="states"></g>
      </svg>
    </div>
    <div class="hr"></div>
    <div class="mini muted">Transições</div>
    <div id="transitionsList" class="scroll mini"></div>
  </div>


  <div class="card">
    <h2>Operações entre AFDs</h2>
    <div class="toolbar">
      <button id="unionBtn" class="btn-soft">União</button>
      <button id="intersectionBtn" class="btn-soft">Interseção</button>
      <button id="equivalenceBtn" class="btn-soft">Equivalência</button>
      <input type="file" id="importFile1" accept="application/json" style="display:none" />
      <input type="file" id="importFile2" accept="application/json" style="display:none" />
    </div>
  </div>

    <script>window.LS_KEY='afn_gr_sim_state_v1';</script>
    <script type="module" src="js/regex.js"></script>
    <script type="module" src="js/grammar.js"></script>
    <script type="module" src="js/run.js"></script>
    <script type="module" src="js/algoview.js"></script>
  </body>

</html>
